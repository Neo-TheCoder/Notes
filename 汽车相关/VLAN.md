# 虚拟局域网VLAN的实现机制
***湖科大教书匠***
是在交换机上实现的：
交换机要能够：
1. 处理带有VLAN标记的帧
IEEE 802.1Q帧
2. 交换机的各端口可以支持不同的端口类型 

## IEEE 802.1Q帧
对以太网的MAC帧格式进行了扩展，插入了**4字节的VLAN标记**
其中最后12bit称为VLAN标识符VID（0 ~ 4095，实际有效范围是1 ~ 4094），唯一地标志了以太网帧属于哪一个VLAN
该类型的帧是交换机来处理，而不是用户主机
**当交换机收到普通的以太网帧时，会将其插入4字节的VLAN标记转变为802.1Q帧，即“打标签”**
**当交换机转发802.1Q帧时，可能会删除其4字节的VLAN标记转变为普通以太网帧，即“去标签”**

## 交换机的端口类型
交换机的端口类型有以下三种：
1. Access
2. Trunk
3. Hybrid

交换机各端口的缺省VLAN ID
例如，思科交换机在用户未配置VLAN时，所有端口都默认属于VLAN1
华为交换机上缺省VLAN ID称为Port VLAN ID，即端口VLAN ID（PVID）。交换机的每个端口有且仅有一个PVID

### Access
用于连接用户计算机，只能属于一个VLAN
Access端口的PVID值与端口所属VLAN的ID相同（默认为1）
#### Access端口接收处理方法：
一般只接受“未打标签”的普通以太网MAC帧，根据接收帧的端口的PVID给帧打标签，插入4字节VLAN标记字段
#### Access端口发送处理方法：
若帧中的VID与端口的PVID相等，则去标签并转发，否则不转发

### Trunk端口
一般用于交换机之间或交换机与路由器之间的互连
Trunk端口可以属于多个VLAN
用户可以设置Trunk端口的PVID值，默认为1









